jQuery(document).ready(function(e){function t(){e("#eprf_license_check").html("");a("GET",{action:"eprf_handle_license_request",command:"get_license_info"},"Retrieving license status. Please wait.")}function a(t,a,r){var n;e(".eckb-top-notice-message").html(""),e.ajax({type:t,dataType:"json",data:a,url:ajaxurl,beforeSend:function(e){i("show",r)}}).done(function(t){if(void 0!==(t=t||"").alert&&alert(t.alert),t.message||void 0===t.output)n=t.message?t.message:s("","Article Rating and Feedback: Error occurred. Please try again later. (L01)","error");else{var a=void 0!==t.output&&t.output?t.output:s("","Please reload the page and try again (L37).","error");e("#eprf_license_check").html(a)}}).fail(function(e,t,a){n=s("Article Rating and Feedback: Error occurred. Please try again later. (L02)",n=a?" ["+a+"]":"unknown error","error")}).always(function(){i("remove",""),n&&(e(".eckb-top-notice-message").replaceWith(n),e("html, body").animate({scrollTop:0},"slow"))})}function i(t,a){if("show"===t){let t='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(a?'<div class="epkb-admin-text">'+a+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(t)}else"remove"===t&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function s(e,t,a){return'<div class="eckb-top-notice-message"><div class="contents"><span class="'+a+'">'+(e?"<h4>"+e+"</h4>":"")+(t||"")+"</span></div></div>"}function r(t){if(e(".eprf-ratings-gutenberg-editor-container").length>0){let t={position:"fixed",top:e("body .eprf-ratings-gutenberg-editor-container").offset().top+50};e("[dir=rtl]").length?t.left="30px":t.right="30px",e("body .eprf-ratings-gutenberg-editor-container").find(".eprf-stars-module__statistics").css(t)}t.closest(".eprf-stars-module").find(".eprf-stars-module__statistics").show()}e("#eprf-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!1,autoOpen:!1}).hide();let n=e("#ekcb-licenses");e("#eckb_license_tab").hasClass("active")&&t(),e("#wpbody").on("click","#eckb_license_tab",function(e){t()}),n.on("click","#eprf_save_btn",function(t){t.preventDefault();a("POST",{action:"eprf_handle_license_request",eprf_license_key:e("#eprf_license_key").val().trim(),_wpnonce_eprf_license_key:e("#_wpnonce_eprf_license_key").val(),command:"save"},"Saving license...")}),e(document.body).on("click",".show-eprf-stars-module__statistics",function(){r(e(this))}),e(document.body).on("mouseleave",".eprf-stars-module",function(){e(".eprf-stars-module .eprf-stars-module__statistics").hide()}),e(document.body).on("click",".eprf_rating.column-eprf_rating *",!1),e(document.body).on("click","#resetArticleRating",function(){if(void 0===eprf_article_rating_data_delete._wpnonce_edit_article)return alert("Missing EPRF rating data."),!0;if(confirm(eprf_article_rating_data_delete.delete_confirm)){let t=e("#post_ID").val();a("GET",{action:"eprf_handle_reset_article_feedback",_wpnonce_edit_article:eprf_article_rating_data_delete._wpnonce_edit_article,article_id:t},"Wait please..."),e(".eprf-like-count, .eprf-dislike-count").text("0"),e(".eprf-stars-container .epkbfa-star").removeClass("epkbfa-star").addClass("epkbfa-star-o"),e(".eprf-stars-container .epkbfa-star-half-o").removeClass("epkbfa-star-half-o").addClass("epkbfa-star-o"),e(".eprf-stars-module .eprf-stars-module__statistics h6").text(""),e(".eprf-stars-module .eprf-stars-module__statistics table .eprf-stars-module__statistics__stat-wrap__stat-inside").css({width:"0%"}),e(".eprf-stars-module .eprf-stars-module__statistics table tr td:last-child").text("0%")}return!1}),e(document.body).on("click",".eprf-show-statistics-toggle",function(){r(e(this))})});